module initMod
  use paramMod
  use dispmodule
  implicit none
contains

  subroutine initialize(pools_C, pools_N,nlevdecomp) !This subroutine sets the initial C and N values in the pool matrices (content in each soil pool in every depth level + plant)
    
    !INPUT
    
    !OUTPUT
    real(r8), intent(out):: pools_C(:,:), pools_N(:,:)
    
    !INOUT

    !LOCAL
    integer :: nlevdecomp
    integer                :: j
    real(r8),parameter     :: C_tot=20000 !gC/m2
    
    
  !  pools_C=C_tot/(nlevdecomp*pool_types)
  !  pools_C(1,:)=pools_C(1,:)+50
    !pools_C(j,:)2500,3700,5,5,100,100,100,50,2000,2000
    !Order: /LITm LITs SAPb SAPf EcM ErM AM SOMp SOMa SOMc/

  !   pools_C(1,:)= (/2940.39,4480.38,33.30,33.30,5.53,100.00,100.00,163.26,2397.15,3003.17/)
  !   pools_C(2,:)=(/3055.19 ,4652.69,37.87,37.87,5.53,100.00,100.00,141.23,2407.33,2997.55/)
  !   pools_C(3,:)= (/3138.18,4776.10,43.98,43.98,5.53,100.00,100.00,124.93,2393.80,2968.66/)
  !   pools_C(4,:)=(/3026.26,4602.98,41.04,41.04,5.53,100.00,100.00,126.74,2327.24,2886.51/)
  !   pools_C(5,:)= (/2601.65,3951.20,31.12,31.12,5.53,100.00,100.00,134.82,2145.52,2679.10/)
  !   pools_C(6,:)= (/1805.80,2734.23,71.11,71.11,5.53,100.00,100.00,157.93,1733.81,2248.42/)
  !   pools_C(7,:)= (/1557.54,2352.32,83.70,83.70,5.53,100.00,100.00,138.95,1510.28,1944.24/)
  !   pools_C(8,:)= (/1703.55,2574.04,80.87,80.87,5.53,100.00,100.00,135.90,1587.82,2018.12/)
  !   !pools_C(9,:)= (/2052.48,3107.52,78.66,78.66,5.53,100.00,100.00,134.66,1840.60,2334.81/)
  !   !pools_C(10,:)= (/2639.93,4009.69,76.36,76.36,5.53,100.00,100.00,131.85,2198.14,2769.48/)
  ! 
  !   pools_N(1,:)=(/109.283,166.725,3.636,2.747,0.276,5.000,5.000,14.606,214.558,273.861,0.613/)
  !   pools_N(2,:)=(/113.544,173.127,4.138,3.127,0.276,5.000,5.000,12.502,215.212,273.344,0.654/)
  !   pools_N(3,:)=(/116.565,177.618,4.819,3.642,0.276,5.000,5.000,10.972,214.239,271.291,0.706/)
  !   pools_N(4,:)=(/112.148,170.770,4.536,3.430,0.276,5.000,5.000,11.245,210.068,265.799,0.899/)
  !   pools_N(5,:)= (/95.744,145.540,3.547,2.686,0.276,5.000,5.000,12.356,198.149,251.296,1.264/)
  !   pools_N(6,:)= (/65.600, 99.376,8.321,6.311,0.276,5.000,5.000,15.041,165.222,216.876,2.146/)
  !   pools_N(7,:)= (/56.152, 84.824,9.860,7.481,0.276,5.000,5.000,13.180,145.635,190.595,1.101/)
  !   pools_N(8,:)= (/61.502, 92.950,9.430,7.151,0.276,5.000,5.000,12.742,151.573,196.254,1.056/)
  !   !pools_N(9,:)= (/74.569,112.947,8.891,6.731,0.276,5.000,5.000,12.255,170.435,220.250,1.058/)
  ! !  pools_N(10,:)=(/97.019,147.477,8.307,6.276,0.276,5.000,5.000,11.560,196.138,252.139,0.992/)
  ! 




    !TODO: Find better initial values!
    do j=1,nlevdecomp
       pools_C(j,:) = (/1.,1.,1.,1.,1.,1.,1.,1.,1.,1./)
      ! pools_C(j,:)=[real(r8) :: 0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001]*1000
       pools_N(j,1:10) = pools_C(j,1:10)/CN_ratio
     end do
    
    pools_N(:,11) = 1.

  end subroutine initialize


end module initMod
